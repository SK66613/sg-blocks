/* ===== Bonus Wheel (scoped) — SG tokens / typography / radius =====
   Uses:
   Colors:  --color-bg/surface/card/border/text/muted/brand/brand-soft
   Buttons: --btn-primary-bg/text, --btn-secondary-bg/text
   Radius:  --radius-card/btn/input
   Type:    --font-body/head/btn, --fs-*, --fw-*, --it-*, --ul-*
   Shadow:  --shadow-soft, --glow-brand
*/

/* ===================== Bridges (tokens) ===================== */
.blk-bonus-wheel{
  /* Typography bridges */
  --bw-font-body: var(--font-body, Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif);
  --bw-font-head: var(--font-head, var(--bw-font-body));
  --bw-font-btn:  var(--font-btn,  var(--bw-font-body));

  --bw-fs-body: var(--fs-body, 14px);
  --bw-fw-body: var(--fw-body, 400);
  --bw-it-body: var(--it-body, normal);
  --bw-ul-body: var(--ul-body, none);

  --bw-fs-h2: var(--fs-h2, 18px);
  --bw-fw-head: var(--fw-head, 800);
  --bw-it-head: var(--it-head, normal);
  --bw-ul-head: var(--ul-head, none);

  --bw-fs-btn: var(--fs-btn, 14px);
  --bw-fw-btn: var(--fw-btn, 800);
  --bw-it-btn: var(--it-btn, normal);
  --bw-ul-btn: var(--ul-btn, none);

  /* Colors */
  --bw-text:  var(--color-text, #e8f0ff);
  --bw-muted: var(--color-muted, #97aac4);

  --bw-bg:     var(--color-bg, #0f1219);
  --bw-surface:var(--color-surface, #121a2a);
  --bw-card:   var(--color-card, #101827);
  --bw-border: var(--color-border, #263048);

  --bw-acc:     var(--color-brand, #7C5CFF);
  --bw-acc-soft:var(--color-brand-soft, #2A2352);

  /* Buttons */
  --bw-btn-primary-bg:   var(--btn-primary-bg, var(--bw-acc));
  --bw-btn-primary-text: var(--btn-primary-text, #ffffff);
  --bw-btn-secondary-bg: var(--btn-secondary-bg, rgba(255,255,255,.06));
  --bw-btn-secondary-text: var(--btn-secondary-text, var(--bw-text));

  /* Radius */
  --bw-r-card:  var(--radius-card, 16px);
  --bw-r-btn:   var(--radius-btn, 14px);
  --bw-r-input: var(--radius-input, 12px);

  /* Shadows */
  --bw-shadow: var(--shadow-soft, 0 8px 24px rgba(0,0,0,.12));
  --bw-ring:   var(--glow-brand, 0 0 0 3px rgba(124,92,255,.26));

  /* Sizes */
  --bw-wheel-h: 180px;
  --bw-item: 96px;
  --bw-ctl-h: 44px; /* кнопки */
  --bw-gap: 10px;
}

/* Base typography */
.blk-bonus-wheel,
.blk-bonus-wheel *{
  font-family: var(--bw-font-body);
}
.blk-bonus-wheel{
  font-size: var(--bw-fs-body);
  font-weight: var(--bw-fw-body);
  font-style: var(--bw-it-body);
  text-decoration: var(--bw-ul-body);
  color: var(--bw-text);
  -webkit-tap-highlight-color: transparent;
}

/* ===================== Card wrapper ===================== */
.blk-bonus-wheel .bonus-card{
  border: 1px solid var(--bw-border);
  border-radius: var(--bw-r-card);
  padding: 14px;
  background: var(--bw-card);
  box-shadow: var(--bw-shadow);
  overflow: hidden;
}

/* Title (H2) */
.blk-bonus-wheel .bonus-card .h2{
  margin: 0 0 10px;
  font-family: var(--bw-font-head);
  font-size: var(--bw-fs-h2);
  font-weight: var(--bw-fw-head);
  font-style: var(--bw-it-head);
  text-decoration: var(--bw-ul-head);
  line-height: 1.15;
}

/* ===================== Header row ===================== */
.blk-bonus-wheel .bonus-head{
  display:flex;
  align-items:center;
  gap: 12px;
  flex-wrap: wrap;
  margin: 0 0 10px;
}

/* Picked pill */
.blk-bonus-wheel .picked-pill{
  display:flex;
  align-items:center;
  gap: 10px;
  min-height: 40px;
  padding: 8px 12px;
  border-radius: 999px;
  border: 1px solid var(--bw-border);
  background: var(--bw-surface);
  font-weight: calc(var(--bw-fw-body) + 200);
  max-width: 100%;
}
.blk-bonus-wheel .picked-pill img{
  width: 28px;
  height: 28px;
  border-radius: 10px;
  object-fit: cover;
  display:block;
}
.blk-bonus-wheel .picked-pill.muted{
  opacity: .82;
  font-weight: var(--bw-fw-body);
  background: linear-gradient(135deg, rgba(124,92,255,.14), rgba(42,35,82,.35));
  border-color: rgba(255,255,255,.10);
}

/* Coins text */
.blk-bonus-wheel [data-coins]{
  font-variant-numeric: tabular-nums lining-nums;
  font-feature-settings: "tnum" 1, "lnum" 1;
}

/* ===================== Wheel ===================== */
.blk-bonus-wheel .bonus-wheel{
  position: relative;
  height: var(--bw-wheel-h);
  overflow: hidden;
  border-radius: var(--bw-r-card);
  border: 1px solid rgba(255,255,255,.06);
  background:
    linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,0) 60%);
  margin-top: 6px;
}

.blk-bonus-wheel .wheel-track{
  position: relative;
  width: 100%;
  height: 100%;
  touch-action: pan-x;
  user-select: none;
  cursor: grab;
}
.blk-bonus-wheel.dragging .wheel-track{ cursor: grabbing; }

/* Item */
.blk-bonus-wheel .bonus-wheel .bonus{
  all: unset;
  position: absolute;
  left: 50%;
  top: 50%;
  width: var(--bw-item);
  height: var(--bw-item);
  border-radius: var(--bw-r-card);
  overflow: hidden;
  transform: translate(-50%, -50%);
  will-change: transform;
  transition: transform .25s ease, filter .25s ease, opacity .25s ease, box-shadow .25s ease;
}
.blk-bonus-wheel .bonus-wheel .bonus img{
  width: 100%;
  height: 100%;
  object-fit: cover;
  display:block;
}
.blk-bonus-wheel .bonus-wheel .bonus span{
  position: absolute;
  left: 50%;
  bottom: -22px;
  transform: translateX(-50%);
  font-size: 12px;
  opacity: .85;
  white-space: nowrap;
  pointer-events: none;
  color: var(--bw-muted);
}

/* inactive */
.blk-bonus-wheel .bonus-wheel .bonus:not(.active){
  filter: grayscale(.18) brightness(.96);
  opacity: .9;
}

/* active highlight uses brand */
.blk-bonus-wheel .bonus-wheel .bonus.active{
  box-shadow:
    0 0 0 2px rgba(124,92,255,.55) inset,
    0 10px 28px rgba(124,92,255,.30),
    0 0 22px rgba(124,92,255,.22);
}

/* Center glow */
.blk-bonus-wheel .bonus-wheel .wheel-center{
  pointer-events:none;
  position:absolute;
  inset:0;
  background: radial-gradient(ellipse at center, rgba(124,92,255,.12), transparent 55%);
  mask: linear-gradient(#000 30%, transparent 80%);
}

/* ===================== Actions ===================== */
.blk-bonus-wheel .actions{
  margin-top: 12px;
  display: grid;
  grid-template-columns: 1fr 1fr auto;
  gap: 8px;
  align-items: center;
}

/* Buttons (SG tokens) */
.blk-bonus-wheel .actions .btn{
  min-height: var(--bw-ctl-h);
  padding: 0 14px;
  border-radius: var(--bw-r-btn);
  border: 1px solid var(--bw-border);
  cursor: pointer;
  display:inline-flex;
  align-items:center;
  justify-content:center;

  font-family: var(--bw-font-btn);
  font-size: var(--bw-fs-btn);
  font-weight: var(--bw-fw-btn);
  font-style: var(--bw-it-btn);
  text-decoration: var(--bw-ul-btn);
  line-height: 1;

  transition: transform .12s ease, filter .12s ease, box-shadow .12s ease;
}
.blk-bonus-wheel .actions .btn:active{ transform: translateY(1px); }
.blk-bonus-wheel .actions .btn:focus-visible{ outline:none; box-shadow: var(--bw-ring); }

.blk-bonus-wheel .actions .btn.primary{
  background: var(--bw-btn-primary-bg);
  color: var(--bw-btn-primary-text);
  border-color: transparent;
  box-shadow: 0 14px 28px rgba(0,0,0,.16);
}
.blk-bonus-wheel .actions .btn:not(.primary){
  background: var(--bw-btn-secondary-bg);
  color: var(--bw-btn-secondary-text);
}

.blk-bonus-wheel .actions .btn[disabled]{
  opacity: .6;
  pointer-events: none;
  box-shadow: none;
}

/* status text */
.blk-bonus-wheel .actions [data-picked]{
  opacity: .85;
  color: var(--bw-muted);
  white-space: nowrap;
  overflow:hidden;
  text-overflow: ellipsis;
  max-width: 28vw;
}

/* "locked" визуал, но не ломаем клики тоста */
.blk-bonus-wheel .actions .btn.is-locked{
  opacity: .65;
}
.blk-bonus-wheel .actions .btn.is-locked:active{ transform:none; }

/* ===================== Toasts (scoped) ===================== */
.blk-bonus-wheel .toasts{
  position: fixed;
  right: 16px;
  bottom: calc(env(safe-area-inset-bottom,0px) + 16px);
  z-index: 100000;
  display: grid;
  gap: 8px;
  width: min(92vw, 320px);
  pointer-events: none;
}
.blk-bonus-wheel .toast{
  pointer-events: auto;
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 12px 14px;
  border-radius: var(--bw-r-btn);
  color: var(--bw-text);

  background: rgba(18,20,24,.96);
  border: 1px solid rgba(255,255,255,.12);
  box-shadow: 0 10px 24px rgba(0,0,0,.35);

  transform: translateX(120%);
  opacity: 0;
  animation: bw-toast-in .25s ease forwards;
}
.blk-bonus-wheel .toast--error{
  border-color: rgba(255,107,107,.45);
  box-shadow: 0 10px 24px rgba(255,107,107,.15);
}
.blk-bonus-wheel .toast--ok{
  border-color: rgba(55,214,122,.45);
  box-shadow: 0 10px 24px rgba(55,214,122,.15);
}
.blk-bonus-wheel .toast__close{
  margin-left: auto;
  opacity: .7;
  background: transparent;
  border: 0;
  color: inherit;
  cursor: pointer;
  font: inherit;
}
@keyframes bw-toast-in{ to { transform: translateX(0); opacity: 1; } }
@keyframes bw-toast-out{ to { transform: translateX(120%); opacity: 0; } }

/* ===================== Reduce motion ===================== */
@media (prefers-reduced-motion: reduce){
  .blk-bonus-wheel .bonus-wheel .bonus,
  .blk-bonus-wheel .actions .btn{
    transition: none !important;
  }
}
